plot_grid(tsne_pus_plot, tsne_ps_plot, labels = c('Unscaled', 'Scaled'),nrow = 1)
library(knitr)
library(tidyverse)
library(dummies)
library(fastDummies)
library(NMF)
library(maps)
library(ggmap)
library(mapdata)
library(Rtsne)
library(cowplot)
# set default knitr chunks
knitr::opts_chunk$set(
echo = FALSE,  # don't print the code chunk
warning = FALSE,  # don't print warnings
message = FALSE,  # don't print messages
fig.width = 6,  # set default width of figures
fig.height = 4,  # set default height of figures
fig.align = "center",  # always align figure in center
fig.pos = "H",  # always plot figure at the exact location of the code chunk
cache = FALSE)  # don't cache results
load('data/question_data.RData')
ling_orig <- read.table('data/lingData.txt', header=TRUE)
lingloc_orig <- read.table('data/lingLocation.txt', header=TRUE)
states = map_data('state')
switch_cols <- colnames(ling_orig)
switch_cols <- switch_cols[5:(length(switch_cols)-2)]
ling1 <- ling_orig %>% drop_na() %>%
mutate(across(switch_cols, as.factor)) %>%
dummy.data.frame(names = switch_cols, sep='.') %>%
select(-ends_with('.0'))
ling_noloc <- ling1 %>%
select(-c('ID','STATE','CITY','ZIP', 'lat','long'))
ling_loc <- ling1[which(rowSums(ling_noloc) > 0),]
ling_noloc <- ling_noloc[which(rowSums(ling_noloc) > 0),]
tsne_loc <- ling_loc[!duplicated(ling_noloc),]
ling_unique <- ling_noloc %>% distinct() %>% scale()
tsne_pca <- read.csv('other/tsne_pca_results.csv')
tsne_np <- read.csv('other/tsne_nopca_results.csv')
pca_us_plot <- as.data.frame(ling_pca_us$x) %>% ggplot() +
geom_point(aes(x=PC1,y=PC2), shape='o', alpha=0.5) +
theme_minimal()
setwd("~/Documents/fall20/stat215a/stat-215-a/lab2")
knitr::include_graphics('images/tsne_pca_plot.png')
tsne_pus_plot <- tsne_pca %>% ggplot() +
geom_point(aes(x=unscaled_v1, y=unscaled_v2),
shape = 'o', alpha = 0.5) +
theme_minimal() +
labs(x = 'V1', y = 'V2')
tsne_ps_plot <- tsne_pca %>% ggplot() +
geom_point(aes(x=scaled_v1, y=scaled_v2),
shape = 'o', alpha = 0.5)+
theme_minimal() +
labs(x = 'V1', y = 'V2')
tsne_npus_plot <- tsne_np %>% ggplot() +
geom_point(aes(x=unscaled_v1, y=unscaled_v2),
shape = 'o', alpha = 0.5) +
theme_minimal() +
labs(x = 'V1', y = 'V2')
tsne_nps_plot <- tsne_np %>% ggplot() +
geom_point(aes(x=scaled_v1, y=scaled_v2),
shape = 'o', alpha = 0.5)+
theme_minimal() +
labs(x = 'V1', y = 'V2')
tsne_np_pg <- plot_grid(tsne_npus_plot, tsne_nps_plot,
labels = c('Unscaled', 'Scaled'),
nrow = 1)
View(tsne_np)
tsne_npus_plot <- tsne_np %>% ggplot() +
geom_point(aes(x=unscaled_v1, y=unscaled_v1.1),
shape = 'o', alpha = 0.5) +
theme_minimal() +
labs(x = 'V1', y = 'V2')
tsne_nps_plot <- tsne_np %>% ggplot() +
geom_point(aes(x=scaled_v1, y=scaled_v2),
shape = 'o', alpha = 0.5)+
theme_minimal() +
labs(x = 'V1', y = 'V2')
tsne_np_pg <- plot_grid(tsne_npus_plot, tsne_nps_plot,
labels = c('Unscaled', 'Scaled'),
nrow = 1)
tsne_np_pg
knitr::include_graphics('images/tsne_np_plot.png')
setwd("~/Documents/fall20/stat215a/stat-215-a/lab2/R")
source('R/plot_fns.R')
ling_pca_us <- prcomp(ling_noloc, center=F, scale=F)
ling_pca_s <- prcomp(ling_noloc, center=T, scale=T)
ling_km_us3 <- kmeans(ling_noloc, centers=3)
ling_km_us4 <- kmeans(ling_noloc, centers=4)
ling_km_pca_s3 <- kmeans(as.data.frame(ling_pca_s$x),
centers=3)
ling_km_pca_s4 <- kmeans(as.data.frame(ling_pca_s$x),
centers=4)
tsne_np_us <- tsne_np %>% select(c(unscaled_v1, unscaled_v1.1))
ling_tsne_km_us_np3 <- kmeans(tsne_np_us,
centers=3)
ling_tsne_km_us_np4 <- kmeans(tsne_np_us,
centers=4)
source('R/plot_fns.R')
source('R/plot_fns.R')
km3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us3,
title='')
km4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us4,
title='')
km_pca3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s3,
title='')
km_pca4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s4,
title='')
km_tsne3 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np3,
title='')
km_tsne4 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np4,
title='')
km_pg3 <- plot_grid(km3, km_pca3, km_tsne3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_pg4 <- plot_grid(km4, km_pca4, km_tsne4,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_pg <- plot_grid(km_pg3, km_pg4, nrow = 2,
labels = c('3 clust', '4 clust'))
km_pg
source('R/plot_fns.R')
smp <- sample(1:35000, size=7000, replace = F)
km3 <- plot_km(data=as.data.frame(ling_pca_s$x)[smp,], x='PC1', y='PC2',
km=ling_km_us3,
title='')
km4 <- plot_km(data=as.data.frame(ling_pca_s$x)[smp,], x='PC1', y='PC2',
km=ling_km_us4,
title='')
km_pca3 <- plot_km(data=as.data.frame(ling_pca_s$x)[smp,], x='PC1', y='PC2',
km=ling_km_pca_s3,
title='')
km_pca4 <- plot_km(data=as.data.frame(ling_pca_s$x)[smp,], x='PC1', y='PC2',
km=ling_km_pca_s4,
title='')
km_tsne3 <- plot_km(data=tsne_np[smp,], x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np3,
title='')
km_tsne4 <- plot_km(data=tsne_np[smp,], x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np4,
title='')
km_pg3 <- plot_grid(km3, km_pca3, km_tsne3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
source('R/plot_fns.R')
smp <- smp(1:35000, size=7000, replace = F)
smp <- sample(1:35000, size=7000, replace = F)
km3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us3, smp = smp,
title='')
km4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us4, smp = smp,
title='')
km_pca3 <- plot_km(data=as.data.frame(ling_pca_s$x)[smp,], x='PC1', y='PC2',
km=ling_km_pca_s3[smp], smp = smp,
title='')
km_pca4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s4, smp = smp,
title='')
km_tsne3 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np3, smp = smp,
title='')
km_tsne4 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np4, smp = smp,
title='')
km_pg3 <- plot_grid(km3, km_pca3, km_tsne3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
source('R/plot_fns.R')
smp <- sample(1:35000, size=7000, replace = F)
km3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us3, smp = smp,
title='')
km4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us4, smp = smp,
title='')
km_pca3 <- plot_km(data=as.data.frame(ling_pca_s$x)[smp,], x='PC1', y='PC2',
km=ling_km_pca_s3[smp], smp = smp,
title='')
km_pca4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s4, smp = smp,
title='')
km_tsne3 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np3, smp = smp,
title='')
km_tsne4 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np4, smp = smp,
title='')
km_pg3 <- plot_grid(km3, km_pca3, km_tsne3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
source('~/Documents/fall20/stat215a/stat-215-a/lab2/R/plot_fns.R')
smp <- sample(1:35000, size=7000, replace = F)
km3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us3, smp = smp,
title='')
km4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us4, smp = smp,
title='')
km_pca3 <- plot_km(data=as.data.frame(ling_pca_s$x)[smp,], x='PC1', y='PC2',
km=ling_km_pca_s3[smp], smp = smp,
title='')
km_pca4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s4, smp = smp,
title='')
km_tsne3 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np3, smp = smp,
title='')
km_tsne4 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np4, smp = smp,
title='')
km_pg3 <- plot_grid(km3, km_pca3, km_tsne3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
source('~/Documents/fall20/stat215a/stat-215-a/lab2/R/plot_fns.R')
smp <- sample(1:35000, size=7000, replace = F)
km3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us3, smp = smp,
title='')
km4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us4, smp = smp,
title='')
km_pca3 <- plot_km(data=as.data.frame(ling_pca_s$x)[smp,], x='PC1', y='PC2',
km=ling_km_pca_s3[smp], smp = smp,
title='')
km_pca4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s4, smp = smp,
title='')
km_tsne3 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np3, smp = smp,
title='')
km_tsne4 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np4, smp = smp,
title='')
km_pg3 <- plot_grid(km3, km_pca3, km_tsne3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_pg4 <- plot_grid(km4, km_pca4, km_tsne4,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_pg <- plot_grid(km_pg3, km_pg4, nrow = 2,
labels = c('3 clust', '4 clust'))
km_pg
km_tsne3
km_pg3
smp <- sample(1:35000, size=7000, replace = F)
km3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us3, smp = smp,
title='')
km4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us4, smp = smp,
title='')
km_pca3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s3[smp], smp = smp,
title='')
km_pca4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s4, smp = smp,
title='')
km_tsne3 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np3, smp = smp,
title='')
km_tsne4 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np4, smp = smp,
title='')
km_pg3 <- plot_grid(km3, km_pca3, km_tsne3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
smp <- sample(1:35000, size=7000, replace = F)
km3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us3, smp = smp,
title='')
km4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us4, smp = smp,
title='')
km_pca3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s3, smp = smp,
title='')
km_pca4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s4, smp = smp,
title='')
km_tsne3 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np3, smp = smp,
title='')
km_tsne4 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np4, smp = smp,
title='')
km_pg3 <- plot_grid(km3, km_pca3, km_tsne3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_pg4 <- plot_grid(km4, km_pca4, km_tsne4,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_pg <- plot_grid(km_pg3, km_pg4, nrow = 2,
labels = c('3 clust', '4 clust'))
km_pg
smp <- sample(1:35000, size=7000, replace = F)
km3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us3, smp = smp,
title='')
km4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_us4, smp = smp,
title='')
km_pca3 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s3, smp = smp,
title='')
km_pca4 <- plot_km(data=as.data.frame(ling_pca_s$x), x='PC1', y='PC2',
km=ling_km_pca_s4, smp = smp,
title='')
km_tsne3 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np3, smp = smp,
title='')
km_tsne4 <- plot_km(data=tsne_np, x='unscaled_v1', y='unscaled_v1.1',
km=ling_tsne_km_us_np4, smp = smp,
title='')
km_pg3 <- plot_grid(km3, km_pca3, km_tsne3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_pg4 <- plot_grid(km4, km_pca4, km_tsne4, ncol = 3)
km_pg <- plot_grid(km_pg3, km_pg4, nrow = 2)
km_pg
km_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_us3,
title='', smp = smp)
km_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_us4,
title='', smp = smp))
km_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_us3,
title='', smp = smp)
km_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_us4,
title='', smp = smp)
km_pca_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_us3,
title='', smp = smp))
km_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_us3,
title='', smp = smp)
km_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_us4,
title='', smp = smp)
km_pca_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_us3,
title='', smp = smp)
km_pca_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_us4,
title='', smp = smp)
km_tsne_geo3 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np3,
title='', smp = smp)
km_tsne_geo4 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np4,
title='', smp = smp)
km_geo_pg3 <- plot_grid(km_geo3, km_pca_geo3, km_tsne_geo3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_us3,
title='', smp = smp)
km_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_us4,
title='', smp = smp)
km_pca_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_s3,
title='', smp = smp)
km_pca_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_s4,
title='', smp = smp)
km_tsne_geo3 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np3,
title='', smp = smp)
km_tsne_geo4 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np4,
title='', smp = smp)
km_geo_pg3 <- plot_grid(km_geo3, km_pca_geo3, km_tsne_geo3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_geo_pg4 <- plot_grid(km_geo4, km_pca_geo4, km_tsne_geo4,
ncol = 3)
km_geo_pg <- plot_grid(km_geo_pg3, km_geo_pg4, nrow = 2)
km_geo_pg
source('~/Documents/fall20/stat215a/stat-215-a/lab2/R/plot_fns.R')
km_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_us3,
title='', smp = smp)
km_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_us4,
title='', smp = smp)
km_pca_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_s3,
title='', smp = smp)
km_pca_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_s4,
title='', smp = smp)
km_tsne_geo3 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np3,
title='', smp = smp)
km_tsne_geo4 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np4,
title='', smp = smp)
km_geo_pg3 <- plot_grid(km_geo3, km_pca_geo3, km_tsne_geo3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_geo_pg4 <- plot_grid(km_geo4, km_pca_geo4, km_tsne_geo4,
ncol = 3)
km_geo_pg <- plot_grid(km_geo_pg3, km_geo_pg4, nrow = 2)
km_geo_pg
source('~/Documents/fall20/stat215a/stat-215-a/lab2/R/plot_fns.R')
km_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_us3,
title='', smp = smp)
km_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_us4,
title='', smp = smp)
km_pca_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_s3,
title='', smp = smp)
km_pca_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_s4,
title='', smp = smp)
km_tsne_geo3 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np3,
title='', smp = smp)
km_tsne_geo4 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np4,
title='', smp = smp)
km_geo_pg3 <- plot_grid(km_geo3, km_pca_geo3, km_tsne_geo3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_geo_pg4 <- plot_grid(km_geo4, km_pca_geo4, km_tsne_geo4,
ncol = 3)
km_geo_pg <- plot_grid(km_geo_pg3, km_geo_pg4, nrow = 2)
km_geo_pg
km_geo3
unique(as.factor(ling_km_us3$cluster))
smp <- sample(1:35000, size=15000, replace = F)
km_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_us3,
title='', smp = smp)
km_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_us4,
title='', smp = smp)
km_pca_geo3 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_s3,
title='', smp = smp)
km_pca_geo4 <- plot_km_geo(loc=ling_loc, km=ling_km_pca_s4,
title='', smp = smp)
km_tsne_geo3 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np3,
title='', smp = smp)
km_tsne_geo4 <- plot_km_geo(loc=tsne_loc, km=ling_tsne_km_us_np4,
title='', smp = smp)
km_geo_pg3 <- plot_grid(km_geo3, km_pca_geo3, km_tsne_geo3, ncol = 3,
labels = c('No dim. red.', 'PCA', 'tSNE'))
km_geo_pg4 <- plot_grid(km_geo4, km_pca_geo4, km_tsne_geo4,
ncol = 3)
km_geo_pg <- plot_grid(km_geo_pg3, km_geo_pg4, nrow = 2)
km_geo_pg
km_tsne_geo4 <- tsne_loc %>%
filter(long > -125) %>% ggplot() +
geom_polygon(data=states, aes(x=long,y=lat, group=group),
fill='white', color='black') +
geom_point(aes(x=long, y=lat,
color=as.factor(ling_tsne_km_us_np4[which(
tsne_loc$long>-125)])),
shape='x', alpha=0.5) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.ticks.x = element_blank(), axis.text.x = element_blank(),
axis.title.y = element_blank(), axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = 'none')
km_tsne_geo4
km_tsne_geo4
km_tsne_geo4 <- tsne_loc %>%
filter(long > -125) %>% ggplot() +
geom_polygon(data=states, aes(x=long,y=lat, group=group),
fill='white', color='black') +
geom_point(aes(x=long, y=lat,
color=as.factor(ling_tsne_km_us_np4$cluster[which(
tsne_loc$long>-125)])),
shape='x', alpha=0.5) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.ticks.x = element_blank(), axis.text.x = element_blank(),
axis.title.y = element_blank(), axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = 'none')
km_tsne_geo4
km_tsne_geo3 <- tsne_loc %>%
filter(long > -125) %>% ggplot() +
geom_polygon(data=states, aes(x=long,y=lat, group=group),
fill='white', color='black') +
geom_point(aes(x=long, y=lat,
color=as.factor(ling_tsne_km_us_np3$cluster[which(
tsne_loc$long>-125)])),
shape='x', alpha=0.5) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.ticks.x = element_blank(), axis.text.x = element_blank(),
axis.title.y = element_blank(), axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = 'none')
km_tsne_geo3
#Uses code from Lab 5 solutions
ks <- c(3,4)
n=6
stab_checks <- lapply(ks, function(k){
lapply(1:n, function(trial){
return(kmeans(ling_noloc, centers=k)$cluster)
})
})
plt_kmeans <- lapply(stab_checks, function(stab_check) {
lapply(stab_check, function(clust){
ggplot() +
geom_point(data=as.data.frame(ling_pca_s$x),
aes(x = PC1, y = PC2,
color = as.factor(clust)),
shape='o', alpha=0.5) +
labs(color = "Cluster") +
theme(legend.position = 'none')
})
})
plt_kmeans_geo <- lapply(stab_checks, function(stab_check) {
lapply(stab_check, function(clust){
smp <- smp(1:length(ling_loc$long),
size = 7000, replace = F)
ling_loc_smp <- ling_loc[smp,]
clust_smp <- clust[smp]
ling_loc_smp %>% filter(long > -125) %>%
ggplot() +
geom_polygon(data=states,
aes(x=long, y=lat, group=group),
fill='white', color='black') +
geom_point(
aes(x = long, y = lat, color = as.factor(
clust_smp[which(ling_loc_smp$long > -125)])),
shape='x', alpha=0.5) +
labs(color = 'Clusters') +
theme(legend.position = 'none') +
theme_minmal() +
theme(axis.title.x = element_blank(),
axis.ticks.x = element_blank(), axis.text.x = element_blank(),
axis.title.y = element_blank(), axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
})
})
